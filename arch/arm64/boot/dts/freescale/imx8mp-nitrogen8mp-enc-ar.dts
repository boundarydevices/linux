// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright 2023 Boundary Devices
 */

#include "imx8mp-nitrogen8mp-enc.dts"

&iomuxc {
	pinctrl_hog: hoggrp {
		fsl,pins = <
			MX8MP_IOMUXC_HDMI_CEC__HDMIMIX_HDMI_CEC		0x40000019
			MX8MP_IOMUXC_HDMI_DDC_SCL__HDMIMIX_HDMI_SCL	0x400001c3
			MX8MP_IOMUXC_HDMI_DDC_SDA__HDMIMIX_HDMI_SDA	0x400001c3
			MX8MP_IOMUXC_HDMI_HPD__HDMIMIX_HDMI_HPD		0x40000019
			MX8MP_IOMUXC_NAND_DATA01__GPIO3_IO07		0x41	/* J9 pin 17 */
			/* J23 */
			MX8MP_IOMUXC_SAI1_TXD7__GPIO4_IO19		0x41	/* pin 1 */
			MX8MP_IOMUXC_SAI1_RXD4__GPIO4_IO06		0x41	/* pin 3 */
			MX8MP_IOMUXC_SAI1_TXC__GPIO4_IO11		0x41	/* pin 5 */
			MX8MP_IOMUXC_SAI1_RXD5__GPIO4_IO07		0x41	/* pin 7 */
			MX8MP_IOMUXC_GPIO1_IO07__GPIO1_IO07		0x41	/* pin 9 */
			MX8MP_IOMUXC_SAI1_RXD6__GPIO4_IO08		0x41	/* pin 11 */
			MX8MP_IOMUXC_SAI1_TXD4__GPIO4_IO16		0x41	/* pin 13 */
			MX8MP_IOMUXC_SAI1_RXD7__GPIO4_IO09		0x41	/* pin 15 */
			MX8MP_IOMUXC_SAI1_TXFS__GPIO4_IO10		0x41	/* pin 17 */
#if 0
			/* 5V supply enable */
			MX8MP_IOMUXC_SAI1_TXD0__GPIO4_IO12		0x41	/* pin 19 */
#endif
			MX8MP_IOMUXC_ECSPI1_MISO__GPIO5_IO08		0x41	/* pin 21 */
			MX8MP_IOMUXC_SAI1_TXD1__GPIO4_IO13		0x41	/* pin 23 */
			MX8MP_IOMUXC_SAI1_RXD2__GPIO4_IO04		0x41	/* pin 25 */
			MX8MP_IOMUXC_SAI1_TXD2__GPIO4_IO14		0x41	/* pin 27 */
			MX8MP_IOMUXC_SAI1_RXD3__GPIO4_IO05		0x41	/* pin 29 */
#if 0
			/* Tx enable for Uart3 */
			MX8MP_IOMUXC_SAI1_TXD3__GPIO4_IO15		0x41	/* pin 31 */
#endif
			MX8MP_IOMUXC_SAI1_TXD5__GPIO4_IO17		0x41	/* pin 33 */

			MX8MP_IOMUXC_SAI1_MCLK__GPIO4_IO20		0x41	/* pin 4 */
			MX8MP_IOMUXC_SAI5_MCLK__GPIO3_IO25		0x41	/* pin 6 */
			MX8MP_IOMUXC_SAI5_RXD3__GPIO3_IO24		0x41	/* pin 8 */
#if 0
			/* Uart4, I2C4 */
			MX8MP_IOMUXC_ECSPI2_MISO__GPIO5_IO12		0x41	/* Pin 10 */
			MX8MP_IOMUXC_ECSPI2_MOSI__GPIO5_IO11		0x41	/* Pin 12 */
			MX8MP_IOMUXC_ECSPI2_SS0__GPIO5_IO13		0x41	/* Pin 14 */
			MX8MP_IOMUXC_ECSPI2_SCLK__GPIO5_IO10		0x41	/* Pin 16 */
#endif
			MX8MP_IOMUXC_ECSPI1_SS0__GPIO5_IO09		0x41	/* pin 18 */
			MX8MP_IOMUXC_SD1_DATA4__GPIO2_IO06		0x41	/* pin 22 */
			MX8MP_IOMUXC_SD1_DATA5__GPIO2_IO07		0x41	/* pin 24 */
			MX8MP_IOMUXC_SD1_DATA6__GPIO2_IO08		0x41	/* pin 26 */
			MX8MP_IOMUXC_SD1_RESET_B__GPIO2_IO10		0x41	/* pin 28 */
			MX8MP_IOMUXC_SPDIF_TX__GPIO5_IO03		0x41	/* pin 30 */
			MX8MP_IOMUXC_SD1_DATA7__GPIO2_IO09		0x41	/* pin 34 */
			MX8MP_IOMUXC_SAI2_RXD0__GPIO4_IO23		0x41	/* pin 36 */
#if 0
			/* UART3 from nitrogen8mp */
			MX8MP_IOMUXC_ECSPI1_MOSI__GPIO5_IO07		0x41	/* pin 40 */
			MX8MP_IOMUXC_ECSPI1_SCLK__GPIO5_IO06		0x41	/* pin 44 */
#endif
			MX8MP_IOMUXC_UART4_TXD__GPIO5_IO29		0x41	/* pin 42 */
		>;
	};

	pinctrl_i2c4_x: i2c4-xgrp {
		fsl,pins = <
			MX8MP_IOMUXC_ECSPI2_MISO__I2C4_SCL		0x400001c3
			MX8MP_IOMUXC_ECSPI2_SS0__I2C4_SDA		0x400001c3
		>;
	};

	pinctrl_i2c4_x_1: i2c4-x-1grp {
		fsl,pins = <
#define GP_I2C4_X_SCL	<&gpio5 12 GPIO_OPEN_DRAIN>
			MX8MP_IOMUXC_ECSPI2_MISO__GPIO5_IO12        	0x1c3
#define GP_I2C4_X_SDA	<&gpio5 13 GPIO_OPEN_DRAIN>
			MX8MP_IOMUXC_ECSPI2_SS0__GPIO5_IO13        	0x1c3
		>;
	};

	pinctrl_reg_5v: reg-5vgrp {
		fsl,pins = <
#define GP_REG_5V	<&gpio4 12 GPIO_ACTIVE_HIGH>
			MX8MP_IOMUXC_SAI1_TXD0__GPIO4_IO12		0x100
		>;
	};

	pinctrl_uart3: uart3grp {
		fsl,pins = <
			MX8MP_IOMUXC_ECSPI1_SCLK__UART3_DCE_RX		0x140
			MX8MP_IOMUXC_ECSPI1_MOSI__UART3_DCE_TX		0x140
#define GP_UART3_RS485_TX_EN	<&gpio4 15 GPIO_ACTIVE_HIGH>
			MX8MP_IOMUXC_SAI1_TXD3__GPIO4_IO15		0x100
		>;
	};

	pinctrl_uart4: uart4grp {
		fsl,pins = <
			MX8MP_IOMUXC_ECSPI2_SCLK__UART4_DCE_RX		0x140
			MX8MP_IOMUXC_ECSPI2_MOSI__UART4_DCE_TX		0x140
		>;
	};
};

/ {
	model = "Boundary i.MX 8M Plus Nitrogen8MP ENC AR board";
	compatible = "boundary,imx8mp-nitrogen8mp-enc-ar", "fsl,imx8mp";

	i2cmux {
		compatible = "i2c-mux-pinctrl";
		i2c-parent = <&i2c4>;
		#address-cells = <1>;
		#size-cells = <0>;

		i2c4_0: i2c4mux@0 {
			reg = <0>;
			#address-cells = <1>;
			#size-cells = <0>;
		};
	};

	reg_5v: regulator-5v {
		compatible = "regulator-fixed";
		enable-active-high;
		gpio = GP_REG_5V;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_reg_5v>;
		regulator-always-on;
		regulator-max-microvolt = <5000000>;
		regulator-min-microvolt = <5000000>;
		regulator-name = "reg_5v";
	};
};

&ecspi2 {
	status = "disabled";
};

&i2c4_0 {
	clock-frequency = <100000>;
	pinctrl-names = "default", "gpio";
	pinctrl-0 = <&pinctrl_i2c4_x>;
	pinctrl-1 = <&pinctrl_i2c4_x_1>;
	scl-gpios = GP_I2C4_X_SCL;
	sda-gpios = GP_I2C4_X_SDA;
};

&uart3 {
	control-gpios = GP_UART3_RS485_TX_EN;
	linux,rs485-enabled-at-boot-time;
	off_levels = <0>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3>;
	rs232_levels = <0>;
	rs232_txen_mask = <1>;
	rs232_txen_levels = <1>;
	rs485_levels = <0>;	/* enable rx */
	rs485_txen_mask = <1>;
	rs485_txen_levels = <1>;
	rxact_mask = <0>;	/* this is for rx activity led */
	rxact_levels = <0>;
	status = "okay";
};
