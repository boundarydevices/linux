/dts-v1/;
/plugin/;
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/pinctrl/mediatek,mt8188-pinfunc.h>

/ {
	fragment@0 {
		target = <&dpi1>;
		__overlay__ {
			status = "disabled";
		};
	};

	fragment@1 {
		target = <&hdmi0>;
		__overlay__ {
			status = "disabled";
		};
	};

	fragment@2 {
		target = <&hdmi_phy>;
		__overlay__ {
			status = "disabled";
		};
	};

	fragment@3 {
		target = <&sound>;
		__overlay__ {
			dai-link-1 { /* HDMI */
				status = "disabled";
			};

			dai-link-2 { /* DPTX */
				status = "disabled";
			};
		};
	};

	fragment@4 {
		target = <&pio>;
		__overlay__ {
			dsi0_sn65dsi83_pins: dsi0-sn65dsi83-pins {
				pins-irq {
					pinmux = <PINMUX_GPIO128__FUNC_B_GPIO128>;
					bias-pull-down;
					input-enable;
				};

				pins-enable {
					pinmux = <PINMUX_GPIO25__FUNC_B_GPIO25>;
					bias-pull-down;
				};
			};

			ts_dsi0_goodix_pins: ts-dsi0-goodix-pins {
				pins-irq {
					pinmux = <PINMUX_GPIO146__FUNC_B_GPIO146>;
					bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
					input-enable;
				};

				pins-reset {
					pinmux = <PINMUX_GPIO7__FUNC_B_GPIO7>;
					bias-pull-down;
				};
			};
		};
	};

	fragment@5 {
		target = <&dsi0>;
		__overlay__ {
			#address-cells = <1>;
			#size-cells = <0>;
			status = "okay";
			poweron-in-hs-mode = <0>;

			dsi0_fb: panel@0 {
				backlight = <&backlight_lcd0>;
				bits-per-color = <8>;
				bridge-de-active = <0>;
				bus-format = "rgb888";
				clocks = <&vdosys0 30>;
				clock-names = "mipi_clk";
				compatible = "panel,common";
				dsi-format = "rgb888";
				dsi-lanes = <4>;
				mode-skip-eot;
				mode-video;
				mode-video-burst;
				panel-height-mm = <136>;
				panel-width-mm = <217>;
				pinctrl-names = "sn65dsi83";
				pinctrl-0 = <&dsi0_sn65dsi83_pins>;
				power-supply = <&VDD_5V>;
				reg = <0>;
				sn65dsi83 = <&dsi0_to_lvds>;
				spwg;

				display-timings {
					mipi_t: t-dsi-default {
						clock-frequency = <71700000>;
						hactive = <1280>;
						vactive = <800>;
						hback-porch = <5>;
						hfront-porch = <151>;
						vback-porch = <2>;
						vfront-porch = <28>;
						hsync-len = <4>;
						vsync-len = <1>;
						hsync-active = <0>;
						vsync-active = <0>;
						de-active = <1>;
					};
				};

				dsi0_to_lvds: dsi0-to-lvds {
					alias = <&dsi0_to_lvds>;
					enable-gpios = <&pio 25 GPIO_ACTIVE_HIGH>;
					i2c-address = <0x2c>;
					i2c-bus = <&i2c_mux_lcd_dsi0>;
					interrupts-extended = <&pio 128 IRQ_TYPE_LEVEL_HIGH>;
				};

				port {
					panel0_in: endpoint {
						remote-endpoint = <&dsi0_out>;
					};
				};
			};

			ports {
				#address-cells = <1>;
				#size-cells = <0>;
				port@1 {
					reg = <1>;
					dsi0_out: endpoint {
						remote-endpoint = <&panel0_in>;
					};
				};
			};
		};
	};

	fragment@6 {
		target = <&i2c_mux_lcd_dsi0>;
		__overlay__ {
			ts_dsi0_goodix: ts-dsi0-goodix@14 {
				compatible = "goodix,gt911";
				display = <&dsi0>;
				esd-recovery-timeout-ms = <2000>;
				interrupts-extended = <&pio 146 IRQ_TYPE_LEVEL_HIGH>;
				irq-gpios = <&pio 146 GPIO_ACTIVE_HIGH>;
				pinctrl-names = "default";
				pinctrl-0 = <&ts_dsi0_goodix_pins>;
				reg = <0x14>; /* 0x14 or 0x5d */
				reset-gpios = <&pio 7 GPIO_ACTIVE_HIGH>;
			};
		};
	};
};
